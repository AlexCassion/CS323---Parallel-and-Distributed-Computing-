

from multiprocessing import Process, Queue, Manager
import time
from typing import List


def compute_gwa_process(subject_name: str, grade: float, process_id: int, result_queue: Queue):
    """
    Compute GWA for a single subject using multiprocessing.
    
    Args:
        subject_name: Name of the subject
        grade: Grade value
        process_id: Identifier for the process
        result_queue: Queue to store results
    """
 
    time.sleep(0.01)
    
    
    gwa = grade
    
    # Store result in queue
    result_queue.put({
        'subject': subject_name,
        'grade': grade,
        'process_id': process_id
    })
    
    print(f"[Process-{process_id}] {subject_name}: {grade:.2f}")


def get_user_input() -> List[tuple]:
    """
    Get grades from user input in a creative and user-friendly way.
    
    Returns:
        List of tuples containing (subject_name, grade)
    """
    print("=" * 60)
    print("üìö GRADE COMPUTING SYSTEM - Multiprocessing Version")
    print("=" * 60)
    
    subjects = []
    
    num_subjects = int(input("\nHow many subjects do you want to enter? "))
    
    for i in range(num_subjects):
        print(f"\n--- Subject {i+1} ---")
        subject_name = input("Subject name: ")
        while True:
            try:
                grade = float(input(f"Grade for {subject_name}: "))
                if 0 <= grade <= 100:
                    subjects.append((subject_name, grade))
                    break
                else:
                    print("Please enter a grade between 0 and 100.")
            except ValueError:
                print("Invalid input. Please enter a numeric grade.")
    
    return subjects


def calculate_overall_gwa(grades: List[float]) -> float:
    """Calculate the overall GWA from all grades."""
    return sum(grades) / len(grades) if grades else 0


def main():
    """Main execution function for multiprocessing approach."""
 
    subjects = get_user_input()
    
    if not subjects:
        print("No subjects entered!")
        return
    
    print("\n" + "=" * 60)
    print("‚ö° Processing grades using MULTIPROCESSING...")
    print("=" * 60 + "\n")
    
   
    start_time = time.time()
    
 
    result_queue = Queue()
    
   
    processes = []
    
    for idx, (subject_name, grade) in enumerate(subjects):
        process = Process(
            target=compute_gwa_process,
            args=(subject_name, grade, idx + 1, result_queue)
        )
        processes.append(process)
        process.start()
    

    for process in processes:
        process.join()
    

    end_time = time.time()
    execution_time = end_time - start_time
    
   
    results = []
    while not result_queue.empty():
        results.append(result_queue.get())
   
    all_grades = [grade for _, grade in subjects]
    overall_gwa = calculate_overall_gwa(all_grades)
    

    print("\n" + "=" * 60)
    print("üìä FINAL RESULTS")
    print("=" * 60)
    print(f"\nTotal Subjects: {len(subjects)}")
    print(f"Overall GWA: {overall_gwa:.2f}")
    print(f"‚è±Ô∏è  Execution Time: {execution_time:.6f} seconds")
    print("\n" + "=" * 60)
    
    return execution_time, overall_gwa


if __name__ == "__main__":
    main()
